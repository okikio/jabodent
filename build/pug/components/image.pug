mixin image(value = {})
  -
    let _class = value.class;
    let _picClass = value.picclass;
    let _loading = value.loading || "lazy";
    let _figClass = value.figclass !== "" ? (value.figclass || "min-h-300") : "";
    let src = value.src || "cloudinary/city";
    let alt = value.alt || "Alternate text";

    let cloudinaryTest = /^cloudinary\//.test(src);
    //- ,f_auto,fl_lossy,dpr_auto
    let origin = "https://res.cloudinary.com/okikio-assets/image/upload/";
    let urlParse = (filters = "") => cloudinaryTest ? `${origin + filters}/${src.replace(/^cloudinary\//, "")}` : src;

  figure.img(class=_figClass itemprop="image" itemscope itemtype="https://schema.org/ImageObject")
    .img-overlay
    picture(class=_picClass)
      //- div.plchldr-img(class=_class)
        .placeholder-img
          img(src!=`${urlParse("w_50,q_auto")}.jpeg` sizes="50px" width="50px"  alt=alt loading="lazy")
      .core-img-pic
        img.img-core(data-src!=`${urlParse("w_auto,q_100")}.webp`  class=_class alt=alt loading=_loading itemprop="url")&attributes(attributes)

      noscript Javascript is necessary for this sites awesome experience.
        - var n = 4;
        - let srcset = `${urlParse(`w_auto,q_auto`)}.webp 300w`;

        while n <= 21
          - srcset += `, ${urlParse(`w_${n * 100},q_100`)}.webp ${n * 100}w`;
          - n ++

        img.no-script-img(class=_class srcset=srcset src!=`${urlParse("w_auto,q_auto")}.jpeg` alt=alt loading=_loading itemprop="url")&attributes(attributes)
